<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>電卓</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
    />

    <!-- ここからアイコン等 -->
    <meta name="msapplication-square70x70logo" content="/site-tile-70x70.png" />
    <meta
      name="msapplication-square150x150logo"
      content="./etc/site-tile-150x150.png"
    />
    <meta
      name="msapplication-wide310x150logo"
      content="./etc/site-tile-310x150.png"
    />
    <meta
      name="msapplication-square310x310logo"
      content="./etc/site-tile-310x310.png"
    />
    <link
      rel="shortcut icon"
      type="image/vnd.microsoft.icon"
      href="./etc/favicon.ico"
    />
    <link rel="icon" type="image/vnd.microsoft.icon" href="./etc/favicon.ico" />
    <link
      rel="apple-touch-icon"
      sizes="57x57"
      href="./etc/apple-touch-icon-57x57.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="60x60"
      href="./etc/apple-touch-icon-60x60.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="./etc/apple-touch-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="76x76"
      href="./etc/apple-touch-icon-76x76.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="./etc/apple-touch-icon-114x114.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="120x120"
      href="./etc/apple-touch-icon-120x120.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="144x144"
      href="./etc/apple-touch-icon-144x144.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="152x152"
      href="./etc/apple-touch-icon-152x152.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="./etc/apple-touch-icon-180x180.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="36x36"
      href="./etc/android-chrome-36x36.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="48x48"
      href="./etc/android-chrome-48x48.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="72x72"
      href="./etc/android-chrome-72x72.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="96x96"
      href="./etc/android-chrome-96x96.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="128x128"
      href="./etc/android-chrome-128x128.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="144x144"
      href="./etc/android-chrome-144x144.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="152x152"
      href="./etc/android-chrome-152x152.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="./etc/android-chrome-192x192.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="256x256"
      href="./etc/android-chrome-256x256.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="384x384"
      href="./etc/android-chrome-384x384.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="512x512"
      href="./etc/android-chrome-512x512.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="36x36"
      href="./etc/icon-36x36.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="48x48"
      href="./etc/icon-48x48.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="72x72"
      href="./etc/icon-72x72.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="96x96"
      href="./etc/icon-96x96.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="128x128"
      href="./etc/icon-128x128.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="144x144"
      href="./etc/icon-144x144.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="152x152"
      href="./etc/icon-152x152.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="160x160"
      href="./etc/icon-160x160.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="./etc/icon-192x192.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="196x196"
      href="./etc/icon-196x196.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="256x256"
      href="./etc/icon-256x256.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="384x384"
      href="./etc/icon-384x384.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="512x512"
      href="./etc/icon-512x512.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="./etc/icon-16x16.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="24x24"
      href="./etc/icon-24x24.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="./etc/icon-32x32.png"
    />
    <!-- ここまでアイコン等 -->
    <!-- <link rel="manifest" href="./etc/manifest.json" /> -->
    <!-- bootstrapを読み込む -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD"
      crossorigin="anonymous"
    />
    <script src="https://cdn.jsdelivr.net/npm/js-cookie/src/js.cookie.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
      crossorigin="anonymous"
    ></script>
    <style>
      /* 基本装飾 */
      #black01 {
        background-color: #333;
        color: #fff;
      }
      #notblack {
        background-color: white;
        color: black;
      }
      button {
        padding: 10px;
        width: 100%;
        height: 100px;
      }
      a {
        color: #fff;
        text-decoration: none;
        white-space: nowrap;
      }
      li {
        margin: 2rem 0;
      }
      #btn-menu {
        border: 1px solid #999;
        background: transparent;
        color: #fff;
        padding: 0.5rem 1rem;
        font-size: 1rem;
        cursor: pointer;
        line-height: 1;
      }
      nav {
        display: flex;
        background: #0bd;
        position: absolute;
        z-index: 1;
        top: 3.125rem;
        right: 0;
        overflow-x: hidden;
        text-align: center;
        width: 0;
        transition: 0.5s;
      }
      nav.open-menu {
        width: 100%;
      }
    </style>
    <script>
      const ua = navigator.userAgent.toLowerCase(),
        currentUrl = location.href,
        microsoftUrl =
          "https://support.microsoft.com/ja-jp/office/%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%97%E3%82%88%E3%81%86%E3%81%A8%E3%81%97%E3%81%9F-web-%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AF%E3%80%81internet-explorer-%E3%81%A7%E3%81%AF%E5%8B%95%E4%BD%9C%E3%81%97%E3%81%BE%E3%81%9B%E3%82%93-8f5fc675-cd47-414c-9535-12821ddfc554";
      if (ua.indexOf("msie") != -1 || ua.indexOf("trident") != -1) {
        location.href = "microsoft-edge:" + currentUrl;
        window.open(microsoftUrl, "_blank");
        setTimeout(function () {
          location.href = microsoftUrl;
        }, 1);
      }
    </script>
  </head>
  <body oncontextmenu="return false;" style="user-select: none">
    <h1 style="font-size: 4em; text-align: center">
      電卓<svg
        xmlns="http://www.w3.org/2000/svg"
        width="44"
        height="44"
        style="color: rgb(89, 89, 89)"
        fill="currentColor"
        class="bi bi-three-dots-vertical"
        viewBox="0 0 16 16"
      >
        <path
          d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"
        />
      </svg>
    </h1>
    <nav>
      <ul>
        <li><a href="/">電卓</a></li>
        <li><a href="./changelog">変更ログ</a></li>
      </ul>
    </nav>
    <table align="center">
      <tbody style="background-color: #78b7ff">
        <tr>
          <td
            colspan="4"
            class="display"
            id="display"
            style="font-size: 4em; text-align: right"
          >
            <b id="calc_display">0</b>
          </td>
        </tr>
        <tr>
          <th>
            <button
              type="button"
              class="btn btn-danger"
              onclick="click_calc_bt('del')"
            >
              <i class="fa-solid fa-trash-can fa-4x"></i>
            </button>
          </th>
          <td>
            <button
              type="button"
              class="btn btn-warning"
              onclick="click_calc_bt('rireki')"
            >
              <i class="fa-solid fa-clock-rotate-left fa-4x"></i>
            </button>
          </td>
          <td>
            <button
              type="button"
              class="btn btn-warning"
              onclick="click_calc_bt('percent')"
            >
              <i class="fa-solid fa-percent fa-4x"></i>
            </button>
          </td>
          <td>
            <button
              type="button"
              class="btn btn-warning"
              onclick="click_calc_bt('waru')"
            >
              <i class="fas fa-divide fa-4x"></i>
            </button>
          </td>
        </tr>
        <tr>
          <th>
            <button
              type="button"
              class="btn btn-success"
              onclick="click_calc_bt(1)"
              style="font-size: 4em"
            >
              <i class="fa-solid fa-1"></i>
            </button>
          </th>
          <td>
            <button
              type="button"
              class="btn btn-success"
              onclick="click_calc_bt(2)"
              style="font-size: 4em"
            >
              <i class="fa-solid fa-2"></i>
            </button>
          </td>
          <td>
            <button
              type="button"
              class="btn btn-success"
              onclick="click_calc_bt(3)"
              style="font-size: 4em"
            >
              <i class="fa-solid fa-3"></i>
            </button>
          </td>
          <td>
            <button
              type="button"
              class="btn btn-warning"
              onclick="click_calc_bt('kk')"
            >
              <i class="fa-solid fa-xmark fa-4x"></i>
            </button>
          </td>
        </tr>
        <tr>
          <th>
            <button
              type="button"
              class="btn btn-success"
              onclick="click_calc_bt(4)"
              style="font-size: 4em"
            >
              <i class="fa-solid fa-4"></i>
            </button>
          </th>
          <td>
            <button
              type="button"
              class="btn btn-success"
              onclick="click_calc_bt(5)"
              style="font-size: 4em"
            >
              <i class="fa-solid fa-5"></i>
            </button>
          </td>
          <td>
            <button
              type="button"
              class="btn btn-success"
              onclick="click_calc_bt(6)"
              style="font-size: 4em"
            >
              <i class="fa-solid fa-6"></i>
            </button>
          </td>
          <td>
            <button
              type="button"
              class="btn btn-warning"
              onclick="click_calc_bt('hiku')"
            >
              <i class="fa-solid fa-minus fa-4x"></i>
            </button>
          </td>
        </tr>

        <tr>
          <th>
            <button
              type="button"
              class="btn btn-success"
              onclick="click_calc_bt(7)"
              style="font-size: 4em"
            >
              <i class="fa-solid fa-7"></i>
            </button>
          </th>
          <td>
            <button
              type="button"
              class="btn btn-success"
              onclick="click_calc_bt(8)"
              style="font-size: 4em"
            >
              <i class="fa-solid fa-8"></i>
            </button>
          </td>
          <td>
            <button
              type="button"
              class="btn btn-success"
              onclick="click_calc_bt(9)"
              style="font-size: 4em"
            >
              <i class="fa-solid fa-9"></i>
            </button>
          </td>
          <td>
            <button
              type="button"
              class="btn btn-warning"
              onclick="click_calc_bt('tasu')"
            >
              <i class="fa-solid fa-plus fa-4x"></i>
            </button>
          </td>
        </tr>
        <tr>
          <th>
            <button
              type="button"
              class="btn btn-success"
              onclick="click_calc_bt(0)"
              style="font-size: 4em"
            >
              <i class="fa-solid fa-0"></i>
            </button>
          </th>
          <td>
            <button
              type="button"
              class="btn btn-success"
              onclick="click_calc_bt('dot')"
              style="font-size: 4em"
            >
              <i class="fa-solid fa-circle" style="font-size: large"></i>
            </button>
          </td>
          <td>
            <button
              type="button"
              class="btn btn-warning"
              onclick="click_calc_bt('ikoru')"
              style="font-size: 4em"
            >
              <i class="fa-solid fa-equals"></i>
            </button>
          </td>
          <td>
            <button
              type="button"
              class="btn btn-danger"
              onclick="click_calc_bt('hitotukesu')"
            >
              <i class="fa-solid fa-delete-left fa-4x"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
    <script>
      window.onload = function onLoad() {
        target = document.getElementById("calc_display");
        target.innerHTML = Cookies.get("old_calc_display") ?? "0";
      };
      window.addEventListener("DOMContentLoaded", () => {
        if (matchMedia("(prefers-color-scheme: dark)").matches) {
          document
            .getElementsByTagName("body")[0]
            .setAttribute("id", "black01");
          document
            .getElementsByTagName("tbody")[0]
            .setAttribute("style", "background-color: #002c5e");
          document
            .getElementsByTagName("svg")[0]
            .setAttribute("style", "color: rgb(221, 221, 221)");
        } else {
          document
            .getElementsByTagName("body")[0]
            .setAttribute("id", "notblack");
          document
            .getElementsByTagName("tbody")[0]
            .setAttribute("style", "background-color: #78b7ff");
          document
            .getElementsByTagName("svg")[0]
            .setAttribute("style", "color: rgb(89, 89, 89)");
        }
      });
      const btn = document.getElementsByTagName("svg")[0];
      const nav = document.querySelector("nav");
      document.addEventListener("keypress", keypress_ivent);
      function keypress_ivent(e) {
        if (
          e.key === "1" ||
          e.key === "2" ||
          e.key === "3" ||
          e.key === "4" ||
          e.key === "5" ||
          e.key === "6" ||
          e.key === "7" ||
          e.key === "8" ||
          e.key === "9" ||
          e.key === "0" ||
          e.key === "." ||
          e.key === "*" ||
          e.key === "+" ||
          e.key === "-" ||
          e.key === "/"
        ) {
          if (document.getElementById("calc_display").innerHTML === "0")
            return (document.getElementById("calc_display").innerHTML = e.key
              .replaceAll("*", "×")
              .replaceAll("/", "÷"));
          document.getElementById("calc_display").innerHTML =
            document.getElementById("calc_display").innerHTML +
            e.key.replaceAll("*", "×").replaceAll("/", "÷");
        } else if (e.key === "Enter") {
          let siki = document
            .getElementById("calc_display")
            .innerHTML.replaceAll("×", "*")
            .replaceAll("÷", "/");
          try {
            document.getElementById("calc_display").innerHTML = eval(siki);
          } catch (e) {
            console.log("エラーが発生しました。\n" + e);
          }
        }
        return false;
      }
      btn.addEventListener("click", () => {
        nav.classList.toggle("open-menu");
      });
      document.getElementById("calc_display").addEventListener("change", () => {
        Cookies.set(
          "old_calc_display",
          document.getElementById("calc_display")
        );
      });
      function click_calc_bt(bt_name) {
        console.log(bt_name);
        if (bt_name === "del") {
          document.getElementById("calc_display").innerHTML = "0";
        }
        if (bt_name === "hitotukesu") {
          if (document.getElementById("calc_display").innerHTML.length === 1) {
            document.getElementById("calc_display").innerHTML = "0";
          } else {
            document.getElementById("calc_display").innerHTML = document
              .getElementById("calc_display")
              .innerHTML.slice(0, -1);
          }
        }
        if (bt_name === "ikoru") {
          let siki = document
            .getElementById("calc_display")
            .innerHTML.replaceAll("×", "*")
            .replaceAll("÷", "/");
          try {
            document.getElementById("calc_display").innerHTML = eval(siki);
          } catch (e) {
            console.log("エラーが発生しました。\n" + e);
          }
        }
        if (bt_name === "percent") {
          if (
            isNaN(
              Number(document.getElementById("calc_display").innerHTML) / 100
            )
          ) {
            return;
          } else {
            document.getElementById("calc_display").innerHTML =
              Number(document.getElementById("calc_display").innerHTML) / 100;
          }
        }
        if (document.getElementById("calc_display").innerHTML === "0") {
          if (
            bt_name === "tasu" ||
            bt_name === "hiku" ||
            bt_name === "kk" ||
            bt_name === "waru" ||
            bt_name === "del" ||
            bt_name === "rireki" ||
            bt_name === "percent" ||
            bt_name === "dot" ||
            bt_name === "ikoru" ||
            bt_name === "hitotukesu"
          )
            return;
          document.getElementById("calc_display").innerHTML = bt_name;
        } else {
          if (
            bt_name === "del" ||
            bt_name === "rireki" ||
            bt_name === "percent" ||
            bt_name === "ikoru" ||
            bt_name === "hitotukesu"
          )
            return;
          if (bt_name === "kk") {
            document.getElementById("calc_display").innerHTML =
              document.getElementById("calc_display").innerHTML + "×";
          } else if (bt_name === "tasu") {
            document.getElementById("calc_display").innerHTML =
              document.getElementById("calc_display").innerHTML + "+";
          } else if (bt_name === "hiku") {
            document.getElementById("calc_display").innerHTML =
              document.getElementById("calc_display").innerHTML + "-";
          } else if (bt_name === "waru") {
            document.getElementById("calc_display").innerHTML =
              document.getElementById("calc_display").innerHTML + "÷";
          } else if (bt_name === "dot") {
            document.getElementById("calc_display").innerHTML =
              document.getElementById("calc_display").innerHTML + ".";
          } else {
            document.getElementById("calc_display").innerHTML =
              document.getElementById("calc_display").innerHTML + bt_name;
          }
        }
      }
    </script>
  </body>
</html>
